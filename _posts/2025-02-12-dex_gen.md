---
layout: post
title: DEXTERITYGEN Foundation Controller for Unprecedented Dexterity
date: 2025-02-10
description: DexGen Reading Notes
tags: robotics
categories: paper-reading
---

> Takeaway: DexGen is a generative model that can translate an unsafe, coarse motion command produced by external policy to safe and fine actions.

## Insight

To achieve effective teleoperation for a dexterous hand, merely retargeting hand motion is insufficient. We can use RL to pretrain large-scale dexterous motion primitives, and then roll out some data using this policy to train a dexterous foundational controller.

## Method

##### Large-Scale Behavior Dataset Generation.

1. Generate a set of object grasps using Grasp Analysis and Rapidly-exploring Random Tree (RRT). Each generated grasp is defined as a tuple (hand joint position, object pose). (over 100K grasp)
2. Train a anygrasp-to-anygrasp policy using RL. We set the goal to be a randomly selected nearby grasp using k nearest-neighbor search. (The authors also introduce other tasks besides anygrasp-to-anygrasp, such fine-grained manipulation and free finger moving etc.)
3. Use this anygrasp-to-anygrasp policy to rollout grasp transition sequences to cover all the possible hand-object interation modes. ($1 \times 10^{10}$ transitions)

##### DexGen Model

Two modules: a diffusion model and a inverse dynamics model.

1. Diffusion Model: given robot state and a mode conditioning variable, characterize the distribution of robot finger keypoint motions. (3D keypoint motions $\Delta x \in \mathbb{R}^{T \times K \times 3}$, $T$ is the future horizon, $K$ is the number of keypoints)
2. Inverse Dynamics Model: given the current observation and the future keypoints, predict the executable actions.

The whole system takes robot state, external motion conditioning, and mode conditioning as input.

The motion conditioning is not fed into the diffusion model directly but as the gradient guidance during the diffusion sampling.

##### Inference: Motion Conditioning with Guided Sampling

The goal is to sample a keypoint motion that is both safe and maximally preserve the input reference motion.

We can use the following formula to sample the keypoint motion:

$$
\Delta x \sim p_\theta(\Delta x \mid o)\mathrm{exp}(-\mathrm{Dist}(\Delta x, \Delta x_{\text{input}}))
$$

Here, $\Delta x_{\text{input}}$ is the input commanded fingertip offset, and $\mathrm{Dist}$ is a distance metric.

Since the action of the robot hand has a high degree of freedom, naive sampling strategies become computationally intractable. The authors propose using gradient guidance in the diffusion sampling process to incorporate motion conditioning. In each diffusion step, we adjust the denoised sample $\Delta x$ by subtracting $\alpha\sum\nabla_{\Delta x}\text{Dist}(\Delta x, \Delta x_\text{input})$ as a guide. Here $\alpha$ is a parameter of the strength of the guidance to be tuned.

## Conclusion

The authors demonstrate that DexGen can effectively translate unsafe, coarse motion commands to safe and fine actions. The model can be used in a teleoperation setting to improve the dexterity of the robot hand.
